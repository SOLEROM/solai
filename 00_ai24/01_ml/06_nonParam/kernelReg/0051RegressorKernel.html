

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>boston house Kernel Regression &#8212; solAiKM</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/clipboard.min.js"></script>
    <script src="../../../../_static/copybutton.js"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '00_ai24/01_ml/06_nonParam/kernelReg/0051RegressorKernel';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Polynomial Regression" href="../polyReg/readme.html" />
    <link rel="prev" title="Kernel Regression" href="0050RegressorKernel.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../../../readme.html">
  
  
  
  
  
  
    <p class="title logo__title">solAiKM</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../readme.html">
                    solai
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">AI24</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../links.html">links</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../readme.html">Machine Learning</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../labs.html">Labs</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../play/lab_normolize.html">normalize or not to normalize</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../play/gridSearchPipeline.html">grid search pipe</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../play/scaler_normalization.html">scaler normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../play/missing_values_fill.html">missing values handeling</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../play/pps.html">PPS -  Predictive Power Score</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../00_intro/readme.html">Intro</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../00_intro/aboutML.html">About ML</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../00_intro/types.html">ML types</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../00_intro/applications.html">applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../00_intro/hyperparams.html">hyperparams</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../00_intro/pipeline.html">pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../00_intro/xorChallengeExample.html">human intuition</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../general/readme.html">General topics</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/classVsRegr.html">Classification vs Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/complexStepDiff.html">Complex Step Differentiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/featureProcessing.html">feature processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/treeEnsemble.html">Tree Ensemble vs Random Forest</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../general/wodoTricks.html">representation tricks</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../scikit/readme.html">Scikit</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/about.html">about scikit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/fetch_openml.html">fetch_openml</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/svc.html">SVC</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../scikit/knn.html">knn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/crossVal.html">cross validation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/classificationReport.html">classification_report</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/decisionFunction.html">Decision function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/fscoreSupport.html">fscoreSupport</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/plot_conf_mat.html">PlotConfusionMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/roc.html">roc curve</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/preprocessing.html">preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/pipe.html">pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/DecisionTreeClassifier.html">DecisionTreeClassifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/CalibratedClassifierCV.html">CalibratedClassifierCV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/checkEstim.html">check_estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/logiReg.html">logistics regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/classMetrics.html">classification metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../scikit/speedup.html">Speeding up scikit-learn</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../01_classification/readme.html">Classification</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../01_classification/binary/readme.html">Binary Classification</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../01_classification/linear/readme.html">linear classifiers</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/linear/classifiers.html">Linear Classifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/linear/reparametrization.html">ReParametrization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/linear/0026LinearClassifier.html">Linear Classifier Random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/linear/0027LinearClassifierTraining.html">Linear Classifier MOONs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/linear/0028LinearClassifier_RealCaseExample.html">Linear Classifier breast</a></li>


</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../01_classification/svm/readme.html">SVM - support vector machine</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/svm/intro.html">Support Vector Machines (SVM)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/svm/0029LinearClassifierSVM.html">SVM Rand classification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/svm/0030LinearClassifierSVM.html">SVM breast classification</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../01_classification/kNear/readme.html">k nearest neighbors</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/kNear/knn.html">KNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/kNear/dimensionality.html">curse of dimensionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/kNear/0031ClassifierKNN.html">KNN random circles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/kNear/0032ClassifierKNN.html">KNN brest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/kNear/lab_Curse_of_Dimensionality.html">Curse lab</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../01_classification/training/readme.html">training</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/training/mnist.html">mnist multicalass example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/training/kfold.html">K FOLD</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/training/dataDivide.html">Data Split</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/training/fitProcessCompare.html">Training Process Comparison</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/resample/readme.html">resampling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../01_classification/decFunc/readme.html">multi-class</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../01_classification/recall/readme.html">precision and recall</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_classification/recall/BalAcc.html">Balanced Accuracy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_classification/roc/readme.html">Roc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_classification/cost/readme.html">cost</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../01_classification/labs/readme.html">classification labs</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/labs/scoreDemo.html">Performance Scores demo</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/labs/0033ConfMatCrossValidation.html">MNIST KNN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/labs/0034ConfMatCrossValidation.html">MNIST SVM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/labs/decFunc.html">Decision Functions Demos</a></li>

<li class="toctree-l4"><a class="reference internal" href="../../01_classification/labs/0035PerformanceScoreMetrics.html">Performance Scores</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/labs/0036PerformanceScoreMetrics.html">Calibrating Imbalanced</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/roc/auc_demo.html">Understanding the AUC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../01_classification/labs/TensorBoard.html">TensorBoard</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../02_featureEng/readme.html">Feature Engineering</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/transforms/normStd.html">Normalizing and Standardizing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/transforms/nonSepr.html">Non Separable Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/transforms/techList.html">technics list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/transforms/0037FeaturesTransform.html">Features Transform case1</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/transforms/0038FeaturesTransform.html">Features Transform case2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/kernelTrick/outline.html">Outline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/kernelTrick/dual.html">Kernel Tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/kernelTrick/0039ClassifierKernelSVM.html">Kernel SVM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/mnist/readme.html">mnist example with kernel trick</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/mnist/0040ClassifierKernelSVM.html">fashion-mnist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../02_featureEng/autouml/readme.html">AutoML</a></li>

</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../03_Statistical/readme.html">Statistical Classification</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../03_Statistical/logisticReg/readme.html">logistic regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../03_Statistical/logisticReg/demo_LogisticRegression.html">Demo Lab Logistic Regression</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../03_Statistical/logisticReg/crossEntropy.html">Cross Entropy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../03_Statistical/logisticReg/0041ClassifierLogisticRegression.html">Mnist Logistic Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../03_Statistical/mapClassifier/readme.html">MAP Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../03_Statistical/mapClassifier/naive.html">Naive Bayes Classifier</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../03_Statistical/mapClassifier/0042ClassifierNaiveBayes.html">Naive Bayes Classifier</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../04_tree/readme.html">Decision Trees</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../04_tree/treeClassifier/readme.html">Decision Trees</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../04_tree/0043ClassifierDecisionTree.html">Circles Decision Tree Classifier</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../04_tree/0044HeartDecisionTree.html">Heart Disease Tree Classifier</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../05_regression/readme.html">Linear Regression</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/linear/readme.html">Linear Regression: Model Imperfection and Steps to Implement Regression</a></li>





<li class="toctree-l3"><a class="reference internal" href="../../05_regression/poly/readme.html">Polynomial regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/phase/readme.html">Phase Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/poly/0045RegressorPolynomialFit.html">Polynomial Fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/poly/0046RegressorPolynomialFit.html">AI Program</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/regularization/ridge.html">Ridge Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/regularization/score.html">R2 Score</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/regularization/0047RegressorL1L2Regularization.html">Least Squares with <span class="math notranslate nohighlight">\({L}^{1}\)</span> / <span class="math notranslate nohighlight">\({L}^{2}\)</span> Regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/regularization/0048RegressorPolynomialFitLasso.html">Polynomial Fit with LASSO Regularization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/ransac/readme.html">outliers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/ransac/huber.html">huber</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/ransac/outiner.html">LS outiner</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/ransac/ransac.html">RANSAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/ransac/0049RegressorRobust.html">Polynomial Fit with RANSAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/wighetedLSQ/readme.html">Weighted Least Squares</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/nonLinSrt/readme.html">Non-Linear Least Squares (NLLS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../05_regression/elasticNet/readme.html">ElasticNet</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../readme.html">Non parametric regression</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="readme.html">kernel regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="multivar.html">Multivariate Kernel Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="0050RegressorKernel.html">Kernel Regression</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">boston house Kernel Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../polyReg/readme.html">Polynomial Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../polyReg/0052RegressorLocalPolynomial.html">Polynomial Regression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spline/readme.html">Spline Interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../regTree/readme.html">Regression Tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../regTree/0053RegressorDecisionTree.html">Regression - Decision Tree</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../07_ensemble/readme.html">Ensemble Methods</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/tradeoff/readme.html">Bias Variance Tradeoff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/tradeoff/bagging.html">Bagging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/tradeoff/oob.html">Out-of-Bag Error (OOB)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/tradeoff/lab_tradeoff_Demo.html">Variance and Bias Trade-off</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/randomForest/readme.html">Random Forest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/randomForest/importances.html">feature importances</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/randomForest/mdi.html">MDI</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/randomForest/permutation.html">permutation importance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/randomForest/0054EnsembleRandomForests.html">Random Forests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/boosting/readme.html">Gradient boosting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/boosting/0055EnsembleGradientBoosting.html">Gradient Boosting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/boosting/adaBoost.html">ada boost</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/boosting/0056EnsembleAdaptiveBoosting.html">Adaptive Boosting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/optimizedLib/lightgbm/readme.html">LightGBM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../07_ensemble/optimizedLib/xgboost/readme.html">XGBoost</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../08_clustering/readme.html">Clustering</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/clustering.html">clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/kmean/readme.html">K-Means</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/kmean/0057ClusteringKMeans.html">K-Means</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/kmean/colorSpaceExample.html">color space quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/kmean/0058ClusteringKMeans.html">K-Means super pixcel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/gmm/readme.html">GMM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/gmm/0059ClusteringGMM.html">Gaussian Mixture Models (GMM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/hierarchical/readme.html">Hierarchical clustering</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/hierarchical/0060ClusteringHierarchical.html">Hierarchical Clustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/density/readme.html">Density</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/density/0061ClusteringDBSCAN.html">DBSCAN Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/hdbscan/readme.html">HDBSCAN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../08_clustering/hdbscan/0062ClusteringHDBSCAN.html">HDBSCAN Demo</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../09_dimred/readme.html">Dimensionality Reduction</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/readme.html">pca</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/rotation.html">Rotation</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/eigDecom.html">Eigen Decomposition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/fullPCA.html">Full PCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/oose.html">oose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/svd.html">svd (pca)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/lab_PCA_gene_demo.html">Gene PCA DEMO LAB</a></li>




<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/0063DimensionalityReductionPCA.html">PCA DEMO FACES</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/pca/0064DimensionalityReductionPCA.html">PCA Brest Cancer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/nonLinPCA/readme.html">non Linear PCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/nonLinPCA/kenrelPCA.html">Kernel PCA</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/nonLinPCA/dualPCA.html">Dual PCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/nonLinPCA/0065DimensionalityReductionKPCA.html">Dimensionality Reduction - Kernel PCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/mds/readme.html">MDS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../09_dimred/mds/0066DimensionalityReductionMDS.html">MultiDimensional Scaling (MDS)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../10_manifold/readme.html">Manifold Learning</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/isomap/readme.html">isoMap</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/isomap/0067ManifoldLearningIsoMap.html">Manifold Learning - IsoMap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/spectral/readme.html">Spectral Clustering</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/tsne/readme.html">TSNE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/tsne/0068ManifoldLearningTSNE.html">t-SNE Demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/entropy/readme.html">Entropy</a></li>


<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/umap/readme.html">Umap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/umap/paramEmbed.html">parametric Embedding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/umap/demo1.html">umap demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/demo.html">manifold concepts demo</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../10_manifold/0069ManifoldLearning.html">Manifold Learning - multi model compare</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../11_anomDet/readme.html">Anomaly detection</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/scores/zscore.html">zscore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/scores/mahalanobis.html">Mahalanobis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/scores/timeSeries.html">Time Series</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/lof/readme.html">Local Outlier Factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/lof/0070AnomalyDetectionLocalOutlierFactor.html">Local Outlier Factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/lof/0071AnomalyDetectionLocalOutlierFactor.html">LOF Exercise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/isoForest/readme.html">Isolation forest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/isoForest/0072AnomalyDetectionIsolationForest.html">Anomaly Detection - Isolation Forest</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../11_anomDet/isoForest/0073AnomalyDetectionIsolationForest.html">Isolation Forest - Exercise</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../12_textAnal/readme.html">text Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../12_textAnal/lab_textOpt.html">text opts</a></li>

</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../03_cv/readme.html">AI Computer Vision</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../03_cv/labs.html">Labs</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../03_cv/convolution/readme.html">Convolution in Deep Learning</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/fullyConnectedDrawback.html">Fully Connected Drawbacks</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/cnnFrqExample.html">CNN for Frequency Estimation Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/0085DeepLearning1DConvFreqEst.html">Convolution for Frequency Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/2d.html">2D Convolution</a></li>





<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/layers.html">Layers in Convolutional Neural Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/pooling.html">Pooling in Convolutional Neural Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/batchNorm.html">Batch Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/lab_batchNorm.html">demo batch norm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/filters.html">Common Filters for 2D Convolution</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/filter_laplacian.html">Common Filters for 2D Convolution</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/concept/recfield.html">Receptive Field (RF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/concept/recField.html">Calc RF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/concept/encodeDecode.html">Encode-Decode Networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/concept/skipConnections.html">skip connections</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/0086DeepLearningConv2DCifar10.html">cifar10-2d-convolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/convolution/0087DeepLearningConv2DFashionMNIST.html">Image Classification Fashion MNIST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/concept/studentTeacherDemo.html">studentTeacherDemo</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../03_cv/pytorch/readme.html">pytorch for CV</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/pytorch/common.html">pytorch layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/pytorch/custom.html">custom nn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/pytorch/microMacro.html">micro macro</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/torchvis/readme.html">TorchVision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/torchvis/transformVers.html">torchvision.transforms</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../03_cv/augm/readme.html">Augmentation</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/augm/0094DeepLearningImageAugmentation.html">Image Augmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/augm/cutMethods.html">Cut Effects</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/augm/0095DeepLearningImageAugmentation.html">Image Augmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/augm/smoothing.html">Smoothing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/augm/0096DeepLearningLabelSmoothing.html">Label Smoothing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/augm/0097DeepLearningRegularizedTraining.html">Regularized Training</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../03_cv/arch/readme.html">compare</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-27"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/darknet53.html">darknet53</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/alexnet.html">AlexNet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/vgg.html">vgg</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/googleNet.html">googleNet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/inception.html">Inception Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/resnet.html">resnet</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/0092DeepLearningResNet.html">ResNet Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/yolo.html">yolo</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/minirocket.html">minirocket</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/arch/lab_minirocket_basicDemo.html">lab simple minirocket demo</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../03_cv/infer/readme.html">Pre-Defined Models</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-28"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/infer/pyInter.html">pytorch Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/infer/sota.html">sota - state-of-the-art</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/infer/zoo.html">zoo(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/infer/0091DeepLearningPreTrainedModels.html">Pre Trained Computer Vision Models</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../03_cv/transf/readme.html">Transfer Learning</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-29"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/compare.html">compare methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/fineTune.html">Fine-Tuning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/freeze.html">Freeze Layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/0093DeepLearningTransferLearning.html">Transfer Learning of resnet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/overfit.html">Transfer overfit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/lab_reducude_demo.html">lab reduce demo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/transformers.html">transformers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/lab_transofmers_basic.html">lab transform basic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/transf/adaptation.html">adaptation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../03_cv/visualize/readme.html">visualize and debug</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../03_cv/location/readme.html">Object Location</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-30"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/location/lab_pretrain_demo.html">pre-trained model for object localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/location/localization.html">Localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/location/0098DeepLearningObjectLocalization.html">Object Localization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/location/detection.html">Detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/location/lab_plot_transforms_e2e.html">Transforms v2: End-to-end object detection/segmentation example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/location/commonArch.html">Common Object Detector Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/location/hms.html">Non Maximum Suppression (NMS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/location/map.html">Mean Average Precision (mAP)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/wrkshp_yolo/readme.html">WorkShop - Object Detection with Yolov8</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/wrkshp_yolo/labelme/readme.html">label example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/wrkshp_yolo/0001BoundingBoxFormat.html">yoloWRKSHP box formats</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../03_cv/segmentation/readme.html">segmentation workshop</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-31"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/segmentation/intro.html">intro</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/segmentation/data.html">data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/segmentation/models.html">models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/segmentation/unet.html">UNET</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../03_cv/wrkshp_unet/readme.html">the task</a></li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/SOLEROM/solai" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/SOLEROM/solai/issues/new?title=Issue%20on%20page%20%2F00_ai24/01_ml/06_nonParam/kernelReg/0051RegressorKernel.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/00_ai24/01_ml/06_nonParam/kernelReg/0051RegressorKernel.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>boston house Kernel Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#revision-history">Revision History</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notations">Notations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-exercise">Code Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-regression">Kernel Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-load-data">Generate / Load Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data">Plot Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-test-data">Training / Test Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-regressor">Kernel Regressor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-regression-estimator">Kernel Regression Estimator</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-a-model-and-optimize-hyper-parameters">Train a Model and Optimize Hyper Parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-results">Regression Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorized-cross-validation-for-kernel-regression">Vectorized Cross Validation for Kernel Regression</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a class="reference external" href="https://fixelalgorithms.gitlab.io/"><img alt="Fixel Algorithms" src="https://i.imgur.com/AqKHVZ0.png" /></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="boston-house-kernel-regression">
<h1>boston house Kernel Regression<a class="headerlink" href="#boston-house-kernel-regression" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p>Notebook by:</p>
<ul class="simple">
<li><p>Royi Avital <a class="reference external" href="mailto:RoyiAvital&#37;&#52;&#48;fixelalgorithms&#46;com">RoyiAvital<span>&#64;</span>fixelalgorithms<span>&#46;</span>com</a></p></li>
</ul>
</div></blockquote>
<section id="revision-history">
<h2>Revision History<a class="headerlink" href="#revision-history" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Date</p></th>
<th class="head"><p>User</p></th>
<th class="head"><p>Content / Changes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.0.000</p></td>
<td><p>07/04/2024</p></td>
<td><p>Royi Avital</p></td>
<td><p>First version</p></td>
</tr>
</tbody>
</table>
<p><a class="reference external" href="https://colab.research.google.com/github/FixelAlgorithmsTeam/FixelCourses/blob/master/AIProgram/2024_02/0051RegressorKernel.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import Packages</span>

<span class="c1"># General Tools</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Machine Learning</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span><span class="p">,</span> <span class="n">RegressorMixin</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_openml</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_predict</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="c1"># Miscellaneous</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">platform</span> <span class="kn">import</span> <span class="n">python_version</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">timeit</span>

<span class="c1"># Typing</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Self</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="c1"># Visualization</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># Jupyter</span>
<span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">get_ipython</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">Dropdown</span><span class="p">,</span> <span class="n">FloatSlider</span><span class="p">,</span> <span class="n">interact</span><span class="p">,</span> <span class="n">IntSlider</span><span class="p">,</span> <span class="n">Layout</span><span class="p">,</span> <span class="n">SelectionSlider</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="notations">
<h2>Notations<a class="headerlink" href="#notations" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><font color='red'>(<strong>?</strong>)</font> Question to answer interactively.</p></li>
<li><p><font color='blue'>(<strong>!</strong>)</font> Simple task to add code for the notebook.</p></li>
<li><p><font color='green'>(<strong>&#64;</strong>)</font> Optional / Extra self practice.</p></li>
<li><p><font color='brown'>(<strong>#</strong>)</font> Note / Useful resource / Food for thought.</p></li>
</ul>
<p>Code Notations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">someVar</span>    <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">#&lt;! Notation for a variable</span>
<span class="n">vVector</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="c1">#&lt;! Notation for 1D array</span>
<span class="n">mMatrix</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">#&lt;! Notation for 2D array</span>
<span class="n">tTensor</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">#&lt;! Notation for nD array (Tensor)</span>
<span class="n">tuTuple</span>    <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1">#&lt;! Notation for a tuple</span>
<span class="n">lList</span>      <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="c1">#&lt;! Notation for a list</span>
<span class="n">dDict</span>      <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="c1">#&lt;! Notation for a dictionary</span>
<span class="n">oObj</span>       <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span> <span class="c1">#&lt;! Notation for an object</span>
<span class="n">dfData</span>     <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span> <span class="c1">#&lt;! Notation for a data frame</span>
<span class="n">dsData</span>     <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span> <span class="c1">#&lt;! Notation for a series</span>
<span class="n">hObj</span>       <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">()</span> <span class="c1">#&lt;! Notation for an object / handler / function handler</span>
</pre></div>
</div>
<section id="code-exercise">
<h3>Code Exercise<a class="headerlink" href="#code-exercise" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Single line fill</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>vallToFill = ???
</pre></div>
</div>
<ul class="simple">
<li><p>Multi Line to Fill (At least one)</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span># You need to start writing
????
</pre></div>
</div>
<ul class="simple">
<li><p>Section to Fill</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>#===========================Fill This===========================#
# 1. Explanation about what to do.
# !! Remarks to follow / take under consideration.
mX = ???

???
#===============================================================#
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Configuration</span>
<span class="c1"># %matplotlib inline</span>

<span class="n">seedNum</span> <span class="o">=</span> <span class="mi">512</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seedNum</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seedNum</span><span class="p">)</span>

<span class="c1"># Matplotlib default color palette</span>
<span class="n">lMatPltLibclr</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="s1">&#39;#ff7f0e&#39;</span><span class="p">,</span> <span class="s1">&#39;#2ca02c&#39;</span><span class="p">,</span> <span class="s1">&#39;#d62728&#39;</span><span class="p">,</span> <span class="s1">&#39;#9467bd&#39;</span><span class="p">,</span> <span class="s1">&#39;#8c564b&#39;</span><span class="p">,</span> <span class="s1">&#39;#e377c2&#39;</span><span class="p">,</span> <span class="s1">&#39;#7f7f7f&#39;</span><span class="p">,</span> <span class="s1">&#39;#bcbd22&#39;</span><span class="p">,</span> <span class="s1">&#39;#17becf&#39;</span><span class="p">]</span>
<span class="c1"># sns.set_theme() #&gt;! Apply SeaBorn theme</span>

<span class="n">runInGoogleColab</span> <span class="o">=</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_ipython</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Constants</span>

<span class="n">FIG_SIZE_DEF</span>    <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">ELM_SIZE_DEF</span>    <span class="o">=</span> <span class="mi">50</span>
<span class="n">CLASS_COLOR</span>     <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">EDGE_COLOR</span>      <span class="o">=</span> <span class="s1">&#39;k&#39;</span>
<span class="n">MARKER_SIZE_DEF</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">LINE_WIDTH_DEF</span>  <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Courses Packages</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../../&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;../../../&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">utils.DataVisualization</span> <span class="kn">import</span> <span class="n">PlotRegressionResults</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># General Auxiliary Functions</span>

<span class="k">def</span> <span class="nf">CosineKernel</span><span class="p">(</span> <span class="n">vU</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vU</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">vU</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">GaussianKernel</span><span class="p">(</span> <span class="n">vU</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">vU</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">TriangularKernel</span><span class="p">(</span> <span class="n">vU</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vU</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vU</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">UniformKernel</span><span class="p">(</span> <span class="n">vU</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vU</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="kernel-regression">
<h2>Kernel Regression<a class="headerlink" href="#kernel-regression" title="Permalink to this heading">#</a></h2>
<p>In this exercise we’ll build an estimator with the Sci Kit Learn API.<br />
It will be based on the concept of Kernel Regression.</p>
<ul class="simple">
<li><p><font color='brown'>(<strong>#</strong>)</font> The <em>Kernel Regression</em> is a non parametric method. The optimization is about its <em>hyper parameters</em>.</p></li>
</ul>
<p>We’ll us the <a class="reference external" href="https://www.openml.org/search?type=data&amp;amp;status=active&amp;amp;id=531">Boston House Prices Dataset</a> (See also <a class="reference external" href="https://www.kaggle.com/datasets/vikrishnan/boston-house-prices">Kaggle - Boston House Prices</a>).<br />
It has 13 features and one target. 2 of the features are categorical features.</p>
<p>The objective is to estimate the <code class="docutils literal notranslate"><span class="pre">MDEV</span></code> of the estimation by optimizing the following hyper parameters:</p>
<ul class="simple">
<li><p>The type of the kernel</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">h</span></code> parameter.</p></li>
</ul>
<p>I this exercise we’ll do the following:</p>
<ol class="arabic simple">
<li><p>Load the <code class="docutils literal notranslate"><span class="pre">Boston</span> <span class="pre">House</span> <span class="pre">Prices</span> <span class="pre">Dataset</span></code> data set using <code class="docutils literal notranslate"><span class="pre">fetch_openml()</span></code>.</p></li>
<li><p>Create a an estimator (Regressor) class using SciKit API:</p></li>
</ol>
<ul class="simple">
<li><p>Implement the constructor.</p></li>
<li><p>Implement the <code class="docutils literal notranslate"><span class="pre">fit()</span></code>, <code class="docutils literal notranslate"><span class="pre">predict()</span></code> and <code class="docutils literal notranslate"><span class="pre">score()</span></code> methods.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Optimize hyper parameters using <em>Leave One Out</em> cross validation.</p></li>
<li><p>Display the output of the model.</p></li>
</ol>
<p>We should get an <em>R2</em> score above 0.75.</p>
<ul class="simple">
<li><p><font color='brown'>(<strong>#</strong>)</font> In order to set the <code class="docutils literal notranslate"><span class="pre">h</span></code> parameter, one should have a look on the distance matrix of the data to get the relevant Dynamic Range of values.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>

<span class="n">lKernelType</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Cosine&#39;</span><span class="p">,</span> <span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span> <span class="s1">&#39;Triangular&#39;</span><span class="p">,</span> <span class="s1">&#39;Uniform&#39;</span><span class="p">]</span>
<span class="c1">#===========================Fill This===========================#</span>
<span class="c1"># 1. Set the range of values of `h` (Bandwidth).</span>
<span class="n">lH</span>          <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">40</span><span class="p">))</span>
<span class="c1">#===============================================================#</span>

<span class="n">lKernels</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;Cosine&#39;</span><span class="p">,</span> <span class="n">CosineKernel</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span> <span class="n">GaussianKernel</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Triangular&#39;</span><span class="p">,</span> <span class="n">TriangularKernel</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Uniform&#39;</span><span class="p">,</span> <span class="n">UniformKernel</span><span class="p">)]</span>

<span class="c1"># Data Visualization</span>
<span class="n">gridNoiseStd</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">numGridPts</span> <span class="o">=</span> <span class="mi">250</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="generate-load-data">
<h2>Generate / Load Data<a class="headerlink" href="#generate-load-data" title="Permalink to this heading">#</a></h2>
<p>Loading the <a class="reference external" href="https://www.openml.org/search?type=data&amp;amp;status=active&amp;amp;id=531">Boston House Prices Dataset</a> (See also <a class="reference external" href="https://www.kaggle.com/datasets/vikrishnan/boston-house-prices">Kaggle - Boston House Prices</a>).<br />
The data has 13 features and one target. 2 of the features are categorical features.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Failing SSL Certificate (&#39;[SSL: CERTIFICATE_VERIFY_FAILED&#39;)</span>
<span class="c1"># In case `fetch_openml()` fails with SSL Certificate issue, run this.</span>
<span class="c1"># import ssl</span>
<span class="c1"># ssl._create_default_https_context = ssl._create_unverified_context</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load Data</span>

<span class="n">dfX</span><span class="p">,</span> <span class="n">dsY</span> <span class="o">=</span> <span class="n">fetch_openml</span><span class="p">(</span><span class="s1">&#39;boston&#39;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">return_X_y</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">as_frame</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">parser</span> <span class="o">=</span> <span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The features data shape: </span><span class="si">{</span><span class="n">dfX</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The labels data shape: </span><span class="si">{</span><span class="n">dsY</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The features data shape: (506, 13)
The labels data shape: (506,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The Features Data</span>
<span class="n">dfX</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.02985</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0</td>
      <td>0.458</td>
      <td>6.430</td>
      <td>58.7</td>
      <td>6.0622</td>
      <td>3</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.12</td>
      <td>5.21</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.08829</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>6.012</td>
      <td>66.6</td>
      <td>5.5605</td>
      <td>5</td>
      <td>311.0</td>
      <td>15.2</td>
      <td>395.60</td>
      <td>12.43</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.14455</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>6.172</td>
      <td>96.1</td>
      <td>5.9505</td>
      <td>5</td>
      <td>311.0</td>
      <td>15.2</td>
      <td>396.90</td>
      <td>19.15</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.21124</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>5.631</td>
      <td>100.0</td>
      <td>6.0821</td>
      <td>5</td>
      <td>311.0</td>
      <td>15.2</td>
      <td>386.63</td>
      <td>29.93</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.17004</td>
      <td>12.5</td>
      <td>7.87</td>
      <td>0</td>
      <td>0.524</td>
      <td>6.004</td>
      <td>85.9</td>
      <td>6.5921</td>
      <td>5</td>
      <td>311.0</td>
      <td>15.2</td>
      <td>386.71</td>
      <td>17.10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The Labels Data</span>
<span class="n">dsY</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    24.0
1    21.6
2    34.7
3    33.4
4    36.2
5    28.7
6    22.9
7    27.1
8    16.5
9    18.9
Name: MEDV, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Info o the Data</span>
<span class="n">dfX</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 506 entries, 0 to 505
Data columns (total 13 columns):
 #   Column   Non-Null Count  Dtype   
---  ------   --------------  -----   
 0   CRIM     506 non-null    float64 
 1   ZN       506 non-null    float64 
 2   INDUS    506 non-null    float64 
 3   CHAS     506 non-null    category
 4   NOX      506 non-null    float64 
 5   RM       506 non-null    float64 
 6   AGE      506 non-null    float64 
 7   DIS      506 non-null    float64 
 8   RAD      506 non-null    category
 9   TAX      506 non-null    float64 
 10  PTRATIO  506 non-null    float64 
 11  B        506 non-null    float64 
 12  LSTAT    506 non-null    float64 
dtypes: category(2), float64(11)
memory usage: 45.1 KB
</pre></div>
</div>
</div>
</div>
<section id="plot-data">
<h3>Plot Data<a class="headerlink" href="#plot-data" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the Data</span>

<span class="c1"># We&#39;ll display the correlation matrix of the data.</span>
<span class="c1"># We&#39;ll add the target variable as the last variable (`MEDV`).</span>

<span class="n">dfData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">dfX</span><span class="p">,</span> <span class="n">dsY</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">hF</span><span class="p">,</span> <span class="n">hA</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">dfData</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">numeric_only</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">(),</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">hA</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/aad3177ec555b6a593c07666de772a1c38bb394edddfb95256fd86f81aae0340.png" src="../../../../_images/aad3177ec555b6a593c07666de772a1c38bb394edddfb95256fd86f81aae0340.png" />
</div>
</div>
<ul class="simple">
<li><p><font color='red'>(<strong>?</strong>)</font> Would you use the above to drop some features?</p></li>
<li><p><font color='red'>(<strong>?</strong>)</font> Do we see all features above? How should we handle those missing?</p></li>
</ul>
</section>
</section>
<section id="training-test-data">
<h2>Training / Test Data<a class="headerlink" href="#training-test-data" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The Training Data </span>

<span class="c1">#===========================Fill This===========================#</span>
<span class="c1"># 1. Convert the `dfX` data frame into a matrix `mX`. Drop the categorical columns.</span>
<span class="c1"># 2. Convert the `dsY` data frame into a vector `vY`.</span>
<span class="c1"># !! You may use the `to_numpy()` method useful.</span>
<span class="n">mX</span> <span class="o">=</span> <span class="n">dfX</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CHAS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAD&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="c1">#&lt;! Drop the categorical data</span>
<span class="n">vY</span> <span class="o">=</span> <span class="n">dsY</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="c1">#===============================================================#</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;type of dsY: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">dsY</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;type of vY: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">vY</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The features data shape: </span><span class="si">{</span><span class="n">mX</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The labels data shape: </span><span class="si">{</span><span class="n">vY</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>type of dsY: &lt;class &#39;pandas.core.series.Series&#39;&gt;
type of vY: &lt;class &#39;numpy.ndarray&#39;&gt;
The features data shape: (506, 11)
The labels data shape: (506,)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><font color='brown'>(<strong>#</strong>)</font> We dropped the <code class="docutils literal notranslate"><span class="pre">CHAS</span></code> feature which is binary.<br />
Binary features are like <em>One Hot Encoding</em>, so we could keep it.</p></li>
<li><p><font color='red'>(<strong>?</strong>)</font> Why are binary features good as input while multi value categorical are not? Think about metrics.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standardizing the Data</span>
<span class="c1"># Since we use `h` it makes sense to keep the dynamic range fo values in tact.</span>
<span class="c1"># In this case we&#39;ll center the data and normalize to have a unit standard deviation.</span>

<span class="c1">#===========================Fill This===========================#</span>
<span class="c1"># 1. Construct the scaler using `StandardScaler` class.</span>
<span class="c1"># 2. Apply the scaler on the data.</span>
<span class="n">oStdScaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">mX</span> <span class="o">=</span> <span class="n">oStdScaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">mX</span><span class="p">)</span>
<span class="c1">#===============================================================#</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="kernel-regressor">
<h2>Kernel Regressor<a class="headerlink" href="#kernel-regressor" title="Permalink to this heading">#</a></h2>
<p>The kernel regression operation is defined by:</p>
<div class="math notranslate nohighlight">
\[\boxed{\hat{f} \left( x \right) = \frac{\sum_{i = 1}^{N} w_{x} \left( {x}_{i} \right) {y}_{i}}{\sum_{i = 1}^{N} {w}_{x} \left( {x}_{i} \right)}}\]</div>
<p>Where <span class="math notranslate nohighlight">\({w}_{x} \left( {x}_{i} \right) = k \left( \frac{ x - x_{i} }{ h } \right)\)</span>.</p>
<p>In this exercise we’ll use Leave One Out validation policy with the <code class="docutils literal notranslate"><span class="pre">cross_val_predict()</span></code> function.</p>
<section id="kernel-regression-estimator">
<h3>Kernel Regression Estimator<a class="headerlink" href="#kernel-regression-estimator" title="Permalink to this heading">#</a></h3>
<p>We could create the linear polynomial fit estimator using a <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> of <code class="docutils literal notranslate"><span class="pre">PolynomialFeatures</span></code> and <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code>.<br />
Yet since this is a simple task it is a good opportunity to exercise the creation of a <em>SciKit Estimator</em>.</p>
<p>We need to provide 4 main methods:</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">__init()__</span></code> Method: The constructor of the object. It should set the kernel type and parameter <code class="docutils literal notranslate"><span class="pre">h</span></code>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">fit()</span></code> Method: The pre processing phase. It keeps a <strong>copy</strong> of the fit data. It should set the <code class="docutils literal notranslate"><span class="pre">h</span></code> parameter if not set.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">predict()</span></code> Method: Prediction of the values.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">score()</span></code> Method: Calculates the <em>R2</em> score.</p></li>
</ol>
<ul class="simple">
<li><p><font color='brown'>(<strong>#</strong>)</font> Make sure you read and understand the <code class="docutils literal notranslate"><span class="pre">ApplyKernelRegression()</span></code> function below.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply Kernel Regression</span>
<span class="c1"># Applies the regression given a callable kernel.</span>
<span class="c1"># It avoids division by 0 in case no reference points are given within the kernel domain.</span>

<span class="k">def</span> <span class="nf">ApplyKernelRegression</span><span class="p">(</span> <span class="n">hKernel</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">paramH</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">mG</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">vY</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">mX</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">metricType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">,</span> <span class="n">zeroThr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-9</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

    <span class="n">mD</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">mX</span><span class="p">,</span> <span class="n">mG</span><span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="n">metricType</span><span class="p">)</span>  <span class="c1">## בomputes the distance between each point</span>
    <span class="n">mW</span> <span class="o">=</span> <span class="n">hKernel</span><span class="p">(</span><span class="n">mD</span> <span class="o">/</span> <span class="n">paramH</span><span class="p">)</span>
    <span class="n">vK</span> <span class="o">=</span> <span class="n">mW</span> <span class="o">@</span> <span class="n">vY</span> <span class="c1">#&lt;! For numerical stability, removing almost zero values</span>
    <span class="n">vW</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mW</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">vI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">vW</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">zeroThr</span> <span class="c1">#&lt;! Calculate only when there&#39;s real data</span>
    <span class="n">vK</span><span class="p">[</span><span class="n">vI</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">vW</span><span class="p">[</span><span class="n">vI</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#&lt;! Remove cases of dividing by 0</span>
    <span class="n">vYPred</span> <span class="o">=</span> <span class="n">vK</span> <span class="o">/</span> <span class="n">vW</span>

    <span class="k">return</span> <span class="n">vYPred</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The Kernel Regressor Class</span>

<span class="k">class</span> <span class="nc">KernelRegressor</span><span class="p">(</span><span class="n">RegressorMixin</span><span class="p">,</span> <span class="n">BaseEstimator</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kernelType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;Gaussian&#39;</span><span class="p">,</span> <span class="n">paramH</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">metricType</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">,</span> <span class="n">lKernels</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="n">lKernels</span><span class="p">):</span>
        <span class="c1">#===========================Fill This===========================#</span>
        <span class="c1"># 1. Add `kernelType` as an attribute of the object.</span>
        <span class="c1"># 2. Define the kernel from `lKernels` as `self.hKernel`.</span>
        <span class="c1"># 3. Add `paramH` as an attribute of the object.</span>

        <span class="c1"># !! Verify the input string of the kernel is within `lKernels`.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernelType</span> <span class="o">=</span> <span class="n">kernelType</span>
        <span class="n">hKernel</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">tKernel</span> <span class="ow">in</span> <span class="n">lKernels</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tKernel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">kernelType</span><span class="p">:</span>
                <span class="n">hKernel</span> <span class="o">=</span> <span class="n">tKernel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">hKernel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hKernel</span> <span class="o">=</span> <span class="n">hKernel</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The kernel in kernelType = </span><span class="si">{</span><span class="n">kernelType</span><span class="si">}</span><span class="s1"> is not in lKernels.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paramH</span>     <span class="o">=</span> <span class="n">paramH</span>
        <span class="c1">#===============================================================#</span>
        <span class="c1"># We must set all input parameters as attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metricType</span> <span class="o">=</span> <span class="n">metricType</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lKernels</span>   <span class="o">=</span> <span class="n">lKernels</span>
        
    
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mX</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">vY</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">mX</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The input `mX` must be an array like of size (n_samples, n_features) !&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">mX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span>  <span class="n">vY</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The input `mX` must be an array like of size (n_samples, n_features) and `vY` must be (n_samples) !&#39;</span><span class="p">)</span>
        
        <span class="c1">#===========================Fill This===========================#</span>
        <span class="c1"># 1. Extract the number of samples.</span>
        <span class="c1"># 2. Set the bandwidth using Silverman&#39;s rule of thumb if it is not set (`None`).</span>
        <span class="c1"># 3. Keep a copy of `mX` as a reference grid of features `mG`.</span>
        <span class="c1"># 4. Keep a copy of `vY` as a reference values.</span>
        <span class="n">numSamples</span> <span class="o">=</span> <span class="n">mX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramH</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Using Silverman&#39;s rule of thumb.</span>
            <span class="c1"># It is optimized for Density Estimation for Univariate Gaussian like data.</span>
            <span class="n">σ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqaure</span><span class="p">(</span><span class="n">mX</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">mX</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">paramH</span> <span class="o">=</span> <span class="mf">1.06</span> <span class="o">*</span> <span class="n">σ</span> <span class="o">*</span> <span class="p">(</span><span class="n">numSamples</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">mG</span> <span class="o">=</span>  <span class="n">mX</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1">#&lt;! Copy!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vY</span> <span class="o">=</span>  <span class="n">vY</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1">#&lt;! Copy!</span>
        <span class="c1">#===============================================================#</span>

        <span class="k">return</span> <span class="bp">self</span>
    
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mX</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">mX</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The input `mX` must be an array like of size (n_samples, n_features) !&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mG</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The input `mX` must be an array like of size (n_samples, n_features) where `n_features` matches the number of feature in `fit()` !&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ApplyKernelRegression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hKernel</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vY</span><span class="p">,</span> <span class="n">mX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metricType</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mX</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">vY</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">:</span>
        <span class="c1"># Return the R2 as the score</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">vY</span><span class="p">)</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">mX</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The number of samples in `mX` must match the number of labels in `vY`.&#39;</span><span class="p">)</span>

        <span class="c1">#===========================Fill This===========================#</span>
        <span class="c1"># 1. Apply the prediction on the input features.</span>
        <span class="c1"># 2. Calculate the R2 score (You may use `r2_score()`).</span>
        <span class="n">vYPred</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">mX</span><span class="p">)</span>
        <span class="n">valR2</span>   <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">vY</span><span class="p">,</span> <span class="n">vYPred</span><span class="p">)</span>
        <span class="c1">#===============================================================#</span>

        <span class="k">return</span> <span class="n">valR2</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="train-a-model-and-optimize-hyper-parameters">
<h2>Train a Model and Optimize Hyper Parameters<a class="headerlink" href="#train-a-model-and-optimize-hyper-parameters" title="Permalink to this heading">#</a></h2>
<p>In this section we’ll optimize the model according to the <code class="docutils literal notranslate"><span class="pre">R2</span></code> score.</p>
<p>We’ll use the <code class="docutils literal notranslate"><span class="pre">r2_score()</span></code> function to calculate the score.<br />
The process to optimize the <em>Hyper Parameters</em> will be as following:</p>
<ol class="arabic simple">
<li><p>Build a data frame to keep the scoring of the different hyper parameters combination.</p></li>
<li><p>Optimize the model:</p></li>
</ol>
<ul class="simple">
<li><p>Construct a model using the current combination of <em>hyper parameters</em>.</p></li>
<li><p>Apply a cross validation process to predict the data using <code class="docutils literal notranslate"><span class="pre">cross_val_predict()</span></code>.</p></li>
<li><p>As the cross validation iterator (The <code class="docutils literal notranslate"><span class="pre">cv</span></code> parameter) use <code class="docutils literal notranslate"><span class="pre">KFold</span></code> to implement <em>Leave One Out</em> policy.</p></li>
</ul>
<ol class="arabic simple" start="3">
<li><p>Calculate the score of the predicted classes.</p></li>
<li><p>Store the result in the performance data frame.</p></li>
</ol>
<ul class="simple">
<li><p><font color='red'>(<strong>?</strong>)</font> While the <code class="docutils literal notranslate"><span class="pre">R2</span></code> score is used to optimize the Hyper Parameter, what loss is used to optimize the model?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating the Data Frame</span>

<span class="c1">#===========================Fill This===========================#</span>
<span class="c1"># 1. Calculate the number of combinations.</span>
<span class="c1"># 2. Create a nested loop to create the combinations between the parameters.</span>
<span class="c1"># 3. Store the combinations as the columns of a data frame.</span>

<span class="c1"># For Advanced Python users: Use iteration tools for create the cartesian product</span>
<span class="n">numComb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lKernelType</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">lH</span><span class="p">)</span>
<span class="n">dData</span>   <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Kernel Type&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">numComb</span><span class="p">}</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">kernelType</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lKernelType</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">jj</span><span class="p">,</span> <span class="n">paramH</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lH</span><span class="p">):</span>
        <span class="n">dData</span><span class="p">[</span><span class="s1">&#39;Kernel Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kernelType</span><span class="p">)</span>
        <span class="n">dData</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">paramH</span><span class="p">)</span>
<span class="c1">#===============================================================#</span>

<span class="n">dfModelScore</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">dData</span><span class="p">)</span>
<span class="n">dfModelScore</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Kernel Type</th>
      <th>h</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cosine</td>
      <td>0.100000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cosine</td>
      <td>0.225641</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Cosine</td>
      <td>0.351282</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Cosine</td>
      <td>0.476923</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cosine</td>
      <td>0.602564</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>155</th>
      <td>Uniform</td>
      <td>4.497436</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>156</th>
      <td>Uniform</td>
      <td>4.623077</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>157</th>
      <td>Uniform</td>
      <td>4.748718</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>158</th>
      <td>Uniform</td>
      <td>4.874359</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>159</th>
      <td>Uniform</td>
      <td>5.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>160 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Optimize the Model</span>

<span class="c1">#===========================Fill This===========================#</span>
<span class="c1"># 1. Iterate over each row of the data frame `dfModelScore`. Each row defines the hyper parameters.</span>
<span class="c1"># 2. Construct the model.</span>
<span class="c1"># 3. Train it on the Train Data Set.</span>
<span class="c1"># 4. Calculate the score.</span>
<span class="c1"># 5. Store the score into the data frame column.</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numComb</span><span class="p">):</span>
    <span class="n">kernelType</span> <span class="o">=</span> <span class="n">dfModelScore</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="s1">&#39;Kernel Type&#39;</span><span class="p">]</span>
    <span class="n">paramH</span>     <span class="o">=</span> <span class="n">dfModelScore</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Processing model </span><span class="si">{</span><span class="n">ii</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s1">03d</span><span class="si">}</span><span class="s1"> out of </span><span class="si">{</span><span class="n">numComb</span><span class="si">}</span><span class="s1"> with `Kernel Type` = </span><span class="si">{</span><span class="n">kernelType</span><span class="si">}</span><span class="s1"> and `h` = </span><span class="si">{</span><span class="n">paramH</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>

    <span class="n">oKerReg</span> <span class="o">=</span> <span class="n">KernelRegressor</span><span class="p">(</span><span class="n">kernelType</span> <span class="o">=</span> <span class="n">kernelType</span><span class="p">,</span> <span class="n">paramH</span> <span class="o">=</span> <span class="n">paramH</span><span class="p">)</span>
    
    <span class="n">vYPred</span> <span class="o">=</span> <span class="n">cross_val_predict</span><span class="p">(</span><span class="n">oKerReg</span><span class="p">,</span> <span class="n">mX</span><span class="p">,</span> <span class="n">vY</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span> <span class="o">=</span> <span class="n">mX</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

    <span class="n">scoreR2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">vY</span><span class="p">,</span> <span class="n">vYPred</span><span class="p">)</span>
    <span class="n">dfModelScore</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span> <span class="s1">&#39;R2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scoreR2</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Finished processing model </span><span class="si">{</span><span class="n">ii</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s1">03d</span><span class="si">}</span><span class="s1"> with `R2 = </span><span class="si">{</span><span class="n">scoreR2</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
<span class="c1">#===============================================================#</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing model 001 out of 160 with `Kernel Type` = Cosine and `h` = 0.1.
Finished processing model 001 with `R2 = -6.0143334549242375.
Processing model 002 out of 160 with `Kernel Type` = Cosine and `h` = 0.22564102564102564.
Finished processing model 002 with `R2 = -5.846558840333477.
Processing model 003 out of 160 with `Kernel Type` = Cosine and `h` = 0.35128205128205126.
Finished processing model 003 with `R2 = -5.240863527423735.
Processing model 004 out of 160 with `Kernel Type` = Cosine and `h` = 0.4769230769230769.
Finished processing model 004 with `R2 = -4.047268714522483.
Processing model 005 out of 160 with `Kernel Type` = Cosine and `h` = 0.6025641025641025.
Finished processing model 005 with `R2 = -2.799042623359844.
Processing model 006 out of 160 with `Kernel Type` = Cosine and `h` = 0.7282051282051282.
Finished processing model 006 with `R2 = -1.586844260286838.
Processing model 007 out of 160 with `Kernel Type` = Cosine and `h` = 0.8538461538461538.
Finished processing model 007 with `R2 = -0.8421109844335779.
Processing model 008 out of 160 with `Kernel Type` = Cosine and `h` = 0.9794871794871794.
Finished processing model 008 with `R2 = -0.14865071561559495.
Processing model 009 out of 160 with `Kernel Type` = Cosine and `h` = 1.1051282051282052.
Finished processing model 009 with `R2 = 0.23076458838521274.
Processing model 010 out of 160 with `Kernel Type` = Cosine and `h` = 1.2307692307692308.
Finished processing model 010 with `R2 = 0.4480127226220688.
Processing model 011 out of 160 with `Kernel Type` = Cosine and `h` = 1.3564102564102565.
Finished processing model 011 with `R2 = 0.5327579280461063.
Processing model 012 out of 160 with `Kernel Type` = Cosine and `h` = 1.4820512820512821.
Finished processing model 012 with `R2 = 0.6252353748703912.
Processing model 013 out of 160 with `Kernel Type` = Cosine and `h` = 1.6076923076923078.
Finished processing model 013 with `R2 = 0.6465126775147094.
Processing model 014 out of 160 with `Kernel Type` = Cosine and `h` = 1.7333333333333334.
Finished processing model 014 with `R2 = 0.7332248763819829.
Processing model 015 out of 160 with `Kernel Type` = Cosine and `h` = 1.858974358974359.
Finished processing model 015 with `R2 = 0.7233313282212972.
Processing model 016 out of 160 with `Kernel Type` = Cosine and `h` = 1.9846153846153847.
Finished processing model 016 with `R2 = 0.7569323380916396.
Processing model 017 out of 160 with `Kernel Type` = Cosine and `h` = 2.1102564102564103.
Finished processing model 017 with `R2 = 0.7544750404481336.
Processing model 018 out of 160 with `Kernel Type` = Cosine and `h` = 2.235897435897436.
Finished processing model 018 with `R2 = 0.7510287664109137.
Processing model 019 out of 160 with `Kernel Type` = Cosine and `h` = 2.3615384615384616.
Finished processing model 019 with `R2 = 0.7897250128557816.
Processing model 020 out of 160 with `Kernel Type` = Cosine and `h` = 2.4871794871794872.
Finished processing model 020 with `R2 = 0.785512883828621.
Processing model 021 out of 160 with `Kernel Type` = Cosine and `h` = 2.612820512820513.
Finished processing model 021 with `R2 = 0.7725739577767134.
Processing model 022 out of 160 with `Kernel Type` = Cosine and `h` = 2.7384615384615385.
Finished processing model 022 with `R2 = 0.7699030815140957.
Processing model 023 out of 160 with `Kernel Type` = Cosine and `h` = 2.864102564102564.
Finished processing model 023 with `R2 = 0.7561766909498184.
Processing model 024 out of 160 with `Kernel Type` = Cosine and `h` = 2.98974358974359.
Finished processing model 024 with `R2 = 0.7531621347762059.
Processing model 025 out of 160 with `Kernel Type` = Cosine and `h` = 3.1153846153846154.
Finished processing model 025 with `R2 = 0.7413572132667272.
Processing model 026 out of 160 with `Kernel Type` = Cosine and `h` = 3.241025641025641.
Finished processing model 026 with `R2 = 0.7297243688576989.
Processing model 027 out of 160 with `Kernel Type` = Cosine and `h` = 3.3666666666666667.
Finished processing model 027 with `R2 = 0.716567185077525.
Processing model 028 out of 160 with `Kernel Type` = Cosine and `h` = 3.4923076923076923.
Finished processing model 028 with `R2 = 0.703356696576499.
Processing model 029 out of 160 with `Kernel Type` = Cosine and `h` = 3.617948717948718.
Finished processing model 029 with `R2 = 0.6904074176636679.
Processing model 030 out of 160 with `Kernel Type` = Cosine and `h` = 3.7435897435897436.
Finished processing model 030 with `R2 = 0.6777214975395125.
Processing model 031 out of 160 with `Kernel Type` = Cosine and `h` = 3.8692307692307693.
Finished processing model 031 with `R2 = 0.6651344083668558.
Processing model 032 out of 160 with `Kernel Type` = Cosine and `h` = 3.994871794871795.
Finished processing model 032 with `R2 = 0.6526966301628636.
Processing model 033 out of 160 with `Kernel Type` = Cosine and `h` = 4.12051282051282.
Finished processing model 033 with `R2 = 0.6404700344330101.
Processing model 034 out of 160 with `Kernel Type` = Cosine and `h` = 4.246153846153845.
Finished processing model 034 with `R2 = 0.6284372802392036.
Processing model 035 out of 160 with `Kernel Type` = Cosine and `h` = 4.371794871794871.
Finished processing model 035 with `R2 = 0.6165398252122973.
Processing model 036 out of 160 with `Kernel Type` = Cosine and `h` = 4.4974358974358974.
Finished processing model 036 with `R2 = 0.6047463834574953.
Processing model 037 out of 160 with `Kernel Type` = Cosine and `h` = 4.623076923076923.
Finished processing model 037 with `R2 = 0.5930542649867989.
Processing model 038 out of 160 with `Kernel Type` = Cosine and `h` = 4.748717948717948.
Finished processing model 038 with `R2 = 0.5814850809414163.
Processing model 039 out of 160 with `Kernel Type` = Cosine and `h` = 4.874358974358974.
Finished processing model 039 with `R2 = 0.5700672498715097.
Processing model 040 out of 160 with `Kernel Type` = Cosine and `h` = 5.0.
Finished processing model 040 with `R2 = 0.5588220773671109.
Processing model 041 out of 160 with `Kernel Type` = Gaussian and `h` = 0.1.
Finished processing model 041 with `R2 = -2.5275364128182267.
Processing model 042 out of 160 with `Kernel Type` = Gaussian and `h` = 0.22564102564102564.
Finished processing model 042 with `R2 = 0.6121394841032461.
Processing model 043 out of 160 with `Kernel Type` = Gaussian and `h` = 0.35128205128205126.
Finished processing model 043 with `R2 = 0.8465883983963417.
Processing model 044 out of 160 with `Kernel Type` = Gaussian and `h` = 0.4769230769230769.
Finished processing model 044 with `R2 = 0.8795229475835388.
Processing model 045 out of 160 with `Kernel Type` = Gaussian and `h` = 0.6025641025641025.
Finished processing model 045 with `R2 = 0.8610906451087534.
Processing model 046 out of 160 with `Kernel Type` = Gaussian and `h` = 0.7282051282051282.
Finished processing model 046 with `R2 = 0.8318094416528194.
Processing model 047 out of 160 with `Kernel Type` = Gaussian and `h` = 0.8538461538461538.
Finished processing model 047 with `R2 = 0.7979584483589652.
Processing model 048 out of 160 with `Kernel Type` = Gaussian and `h` = 0.9794871794871794.
Finished processing model 048 with `R2 = 0.763546154405765.
Processing model 049 out of 160 with `Kernel Type` = Gaussian and `h` = 1.1051282051282052.
Finished processing model 049 with `R2 = 0.7285570311841791.
Processing model 050 out of 160 with `Kernel Type` = Gaussian and `h` = 1.2307692307692308.
Finished processing model 050 with `R2 = 0.6924719067414478.
Processing model 051 out of 160 with `Kernel Type` = Gaussian and `h` = 1.3564102564102565.
Finished processing model 051 with `R2 = 0.6562155118693755.
Processing model 052 out of 160 with `Kernel Type` = Gaussian and `h` = 1.4820512820512821.
Finished processing model 052 with `R2 = 0.6211047647293036.
Processing model 053 out of 160 with `Kernel Type` = Gaussian and `h` = 1.6076923076923078.
Finished processing model 053 with `R2 = 0.5879243957121196.
Processing model 054 out of 160 with `Kernel Type` = Gaussian and `h` = 1.7333333333333334.
Finished processing model 054 with `R2 = 0.5569001059282681.
Processing model 055 out of 160 with `Kernel Type` = Gaussian and `h` = 1.858974358974359.
Finished processing model 055 with `R2 = 0.5279554391630081.
Processing model 056 out of 160 with `Kernel Type` = Gaussian and `h` = 1.9846153846153847.
Finished processing model 056 with `R2 = 0.5009064084845636.
Processing model 057 out of 160 with `Kernel Type` = Gaussian and `h` = 2.1102564102564103.
Finished processing model 057 with `R2 = 0.4755563220273633.
Processing model 058 out of 160 with `Kernel Type` = Gaussian and `h` = 2.235897435897436.
Finished processing model 058 with `R2 = 0.4517308104529788.
Processing model 059 out of 160 with `Kernel Type` = Gaussian and `h` = 2.3615384615384616.
Finished processing model 059 with `R2 = 0.4292841479700531.
Processing model 060 out of 160 with `Kernel Type` = Gaussian and `h` = 2.4871794871794872.
Finished processing model 060 with `R2 = 0.4080930081989712.
Processing model 061 out of 160 with `Kernel Type` = Gaussian and `h` = 2.612820512820513.
Finished processing model 061 with `R2 = 0.38804860047504375.
Processing model 062 out of 160 with `Kernel Type` = Gaussian and `h` = 2.7384615384615385.
Finished processing model 062 with `R2 = 0.3690551695439902.
Processing model 063 out of 160 with `Kernel Type` = Gaussian and `h` = 2.864102564102564.
Finished processing model 063 with `R2 = 0.35103493546629017.
Processing model 064 out of 160 with `Kernel Type` = Gaussian and `h` = 2.98974358974359.
Finished processing model 064 with `R2 = 0.33393186670640873.
Processing model 065 out of 160 with `Kernel Type` = Gaussian and `h` = 3.1153846153846154.
Finished processing model 065 with `R2 = 0.3177084744299288.
Processing model 066 out of 160 with `Kernel Type` = Gaussian and `h` = 3.241025641025641.
Finished processing model 066 with `R2 = 0.3023375508698024.
Processing model 067 out of 160 with `Kernel Type` = Gaussian and `h` = 3.3666666666666667.
Finished processing model 067 with `R2 = 0.287794207769103.
Processing model 068 out of 160 with `Kernel Type` = Gaussian and `h` = 3.4923076923076923.
Finished processing model 068 with `R2 = 0.2740512413202366.
Processing model 069 out of 160 with `Kernel Type` = Gaussian and `h` = 3.617948717948718.
Finished processing model 069 with `R2 = 0.2610777131888252.
Processing model 070 out of 160 with `Kernel Type` = Gaussian and `h` = 3.7435897435897436.
Finished processing model 070 with `R2 = 0.24883939539128808.
Processing model 071 out of 160 with `Kernel Type` = Gaussian and `h` = 3.8692307692307693.
Finished processing model 071 with `R2 = 0.23729990053889138.
Processing model 072 out of 160 with `Kernel Type` = Gaussian and `h` = 3.994871794871795.
Finished processing model 072 with `R2 = 0.2264218506463629.
Processing model 073 out of 160 with `Kernel Type` = Gaussian and `h` = 4.12051282051282.
Finished processing model 073 with `R2 = 0.21616783588512878.
Processing model 074 out of 160 with `Kernel Type` = Gaussian and `h` = 4.246153846153845.
Finished processing model 074 with `R2 = 0.20650111798531423.
Processing model 075 out of 160 with `Kernel Type` = Gaussian and `h` = 4.371794871794871.
Finished processing model 075 with `R2 = 0.19738611077773383.
Processing model 076 out of 160 with `Kernel Type` = Gaussian and `h` = 4.4974358974358974.
Finished processing model 076 with `R2 = 0.18878868848289632.
Processing model 077 out of 160 with `Kernel Type` = Gaussian and `h` = 4.623076923076923.
Finished processing model 077 with `R2 = 0.1806763681255773.
Processing model 078 out of 160 with `Kernel Type` = Gaussian and `h` = 4.748717948717948.
Finished processing model 078 with `R2 = 0.17301840253599154.
Processing model 079 out of 160 with `Kernel Type` = Gaussian and `h` = 4.874358974358974.
Finished processing model 079 with `R2 = 0.16578581086999622.
Processing model 080 out of 160 with `Kernel Type` = Gaussian and `h` = 5.0.
Finished processing model 080 with `R2 = 0.15895136604225946.
Processing model 081 out of 160 with `Kernel Type` = Triangular and `h` = 0.1.
Finished processing model 081 with `R2 = -6.0143334549242375.
Processing model 082 out of 160 with `Kernel Type` = Triangular and `h` = 0.22564102564102564.
Finished processing model 082 with `R2 = -5.846558840333477.
Processing model 083 out of 160 with `Kernel Type` = Triangular and `h` = 0.35128205128205126.
Finished processing model 083 with `R2 = -5.240860967759973.
Processing model 084 out of 160 with `Kernel Type` = Triangular and `h` = 0.4769230769230769.
Finished processing model 084 with `R2 = -4.047132482669339.
Processing model 085 out of 160 with `Kernel Type` = Triangular and `h` = 0.6025641025641025.
Finished processing model 085 with `R2 = -2.798296071014598.
Processing model 086 out of 160 with `Kernel Type` = Triangular and `h` = 0.7282051282051282.
Finished processing model 086 with `R2 = -1.5860891319986843.
Processing model 087 out of 160 with `Kernel Type` = Triangular and `h` = 0.8538461538461538.
Finished processing model 087 with `R2 = -0.8369140976028091.
Processing model 088 out of 160 with `Kernel Type` = Triangular and `h` = 0.9794871794871794.
Finished processing model 088 with `R2 = -0.14691248029552173.
Processing model 089 out of 160 with `Kernel Type` = Triangular and `h` = 1.1051282051282052.
Finished processing model 089 with `R2 = 0.2314432624441468.
Processing model 090 out of 160 with `Kernel Type` = Triangular and `h` = 1.2307692307692308.
Finished processing model 090 with `R2 = 0.4484890155482364.
Processing model 091 out of 160 with `Kernel Type` = Triangular and `h` = 1.3564102564102565.
Finished processing model 091 with `R2 = 0.5285056282605223.
Processing model 092 out of 160 with `Kernel Type` = Triangular and `h` = 1.4820512820512821.
Finished processing model 092 with `R2 = 0.6146724163910834.
Processing model 093 out of 160 with `Kernel Type` = Triangular and `h` = 1.6076923076923078.
Finished processing model 093 with `R2 = 0.6334968063845496.
Processing model 094 out of 160 with `Kernel Type` = Triangular and `h` = 1.7333333333333334.
Finished processing model 094 with `R2 = 0.7168672666217224.
Processing model 095 out of 160 with `Kernel Type` = Triangular and `h` = 1.858974358974359.
Finished processing model 095 with `R2 = 0.7048988851045139.
Processing model 096 out of 160 with `Kernel Type` = Triangular and `h` = 1.9846153846153847.
Finished processing model 096 with `R2 = 0.7353543093661505.
Processing model 097 out of 160 with `Kernel Type` = Triangular and `h` = 2.1102564102564103.
Finished processing model 097 with `R2 = 0.731743174571343.
Processing model 098 out of 160 with `Kernel Type` = Triangular and `h` = 2.235897435897436.
Finished processing model 098 with `R2 = 0.7257535538108972.
Processing model 099 out of 160 with `Kernel Type` = Triangular and `h` = 2.3615384615384616.
Finished processing model 099 with `R2 = 0.7600464443044005.
Processing model 100 out of 160 with `Kernel Type` = Triangular and `h` = 2.4871794871794872.
Finished processing model 100 with `R2 = 0.7516075941372972.
Processing model 101 out of 160 with `Kernel Type` = Triangular and `h` = 2.612820512820513.
Finished processing model 101 with `R2 = 0.7354764791117783.
Processing model 102 out of 160 with `Kernel Type` = Triangular and `h` = 2.7384615384615385.
Finished processing model 102 with `R2 = 0.729643990874307.
Processing model 103 out of 160 with `Kernel Type` = Triangular and `h` = 2.864102564102564.
Finished processing model 103 with `R2 = 0.7122406855468462.
Processing model 104 out of 160 with `Kernel Type` = Triangular and `h` = 2.98974358974359.
Finished processing model 104 with `R2 = 0.7084312619551112.
Processing model 105 out of 160 with `Kernel Type` = Triangular and `h` = 3.1153846153846154.
Finished processing model 105 with `R2 = 0.6957942913842284.
Processing model 106 out of 160 with `Kernel Type` = Triangular and `h` = 3.241025641025641.
Finished processing model 106 with `R2 = 0.6831878437097254.
Processing model 107 out of 160 with `Kernel Type` = Triangular and `h` = 3.3666666666666667.
Finished processing model 107 with `R2 = 0.66854560188787.
Processing model 108 out of 160 with `Kernel Type` = Triangular and `h` = 3.4923076923076923.
Finished processing model 108 with `R2 = 0.6543497241512761.
Processing model 109 out of 160 with `Kernel Type` = Triangular and `h` = 3.617948717948718.
Finished processing model 109 with `R2 = 0.6407772096181051.
Processing model 110 out of 160 with `Kernel Type` = Triangular and `h` = 3.7435897435897436.
Finished processing model 110 with `R2 = 0.627201185816792.
Processing model 111 out of 160 with `Kernel Type` = Triangular and `h` = 3.8692307692307693.
Finished processing model 111 with `R2 = 0.613350105722119.
Processing model 112 out of 160 with `Kernel Type` = Triangular and `h` = 3.994871794871795.
Finished processing model 112 with `R2 = 0.6001586098621644.
Processing model 113 out of 160 with `Kernel Type` = Triangular and `h` = 4.12051282051282.
Finished processing model 113 with `R2 = 0.5871945657792486.
Processing model 114 out of 160 with `Kernel Type` = Triangular and `h` = 4.246153846153845.
Finished processing model 114 with `R2 = 0.5744083988396895.
Processing model 115 out of 160 with `Kernel Type` = Triangular and `h` = 4.371794871794871.
Finished processing model 115 with `R2 = 0.5616549283665744.
Processing model 116 out of 160 with `Kernel Type` = Triangular and `h` = 4.4974358974358974.
Finished processing model 116 with `R2 = 0.5490272913912144.
Processing model 117 out of 160 with `Kernel Type` = Triangular and `h` = 4.623076923076923.
Finished processing model 117 with `R2 = 0.5365694897678108.
Processing model 118 out of 160 with `Kernel Type` = Triangular and `h` = 4.748717948717948.
Finished processing model 118 with `R2 = 0.5243246688200633.
Processing model 119 out of 160 with `Kernel Type` = Triangular and `h` = 4.874358974358974.
Finished processing model 119 with `R2 = 0.5123155034599327.
Processing model 120 out of 160 with `Kernel Type` = Triangular and `h` = 5.0.
Finished processing model 120 with `R2 = 0.5005798908202483.
Processing model 121 out of 160 with `Kernel Type` = Uniform and `h` = 0.1.
Finished processing model 121 with `R2 = -6.0143334549242375.
Processing model 122 out of 160 with `Kernel Type` = Uniform and `h` = 0.22564102564102564.
Finished processing model 122 with `R2 = -5.988603929708586.
Processing model 123 out of 160 with `Kernel Type` = Uniform and `h` = 0.35128205128205126.
Finished processing model 123 with `R2 = -5.917214546093458.
Processing model 124 out of 160 with `Kernel Type` = Uniform and `h` = 0.4769230769230769.
Finished processing model 124 with `R2 = -5.819566565165473.
Processing model 125 out of 160 with `Kernel Type` = Uniform and `h` = 0.6025641025641025.
Finished processing model 125 with `R2 = -5.37518814199993.
Processing model 126 out of 160 with `Kernel Type` = Uniform and `h` = 0.7282051282051282.
Finished processing model 126 with `R2 = -5.114740215805383.
Processing model 127 out of 160 with `Kernel Type` = Uniform and `h` = 0.8538461538461538.
Finished processing model 127 with `R2 = -4.526163285212605.
Processing model 128 out of 160 with `Kernel Type` = Uniform and `h` = 0.9794871794871794.
Finished processing model 128 with `R2 = -3.8999710842788735.
Processing model 129 out of 160 with `Kernel Type` = Uniform and `h` = 1.1051282051282052.
Finished processing model 129 with `R2 = -3.246021911259321.
Processing model 130 out of 160 with `Kernel Type` = Uniform and `h` = 1.2307692307692308.
Finished processing model 130 with `R2 = -2.723340207837504.
Processing model 131 out of 160 with `Kernel Type` = Uniform and `h` = 1.3564102564102565.
Finished processing model 131 with `R2 = -2.142064724232441.
Processing model 132 out of 160 with `Kernel Type` = Uniform and `h` = 1.4820512820512821.
Finished processing model 132 with `R2 = -1.3580990734804552.
Processing model 133 out of 160 with `Kernel Type` = Uniform and `h` = 1.6076923076923078.
Finished processing model 133 with `R2 = -1.0305915998232331.
Processing model 134 out of 160 with `Kernel Type` = Uniform and `h` = 1.7333333333333334.
Finished processing model 134 with `R2 = -0.7589711329801199.
Processing model 135 out of 160 with `Kernel Type` = Uniform and `h` = 1.858974358974359.
Finished processing model 135 with `R2 = -0.3609875860459275.
Processing model 136 out of 160 with `Kernel Type` = Uniform and `h` = 1.9846153846153847.
Finished processing model 136 with `R2 = -0.14222994306607695.
Processing model 137 out of 160 with `Kernel Type` = Uniform and `h` = 2.1102564102564103.
Finished processing model 137 with `R2 = 0.030291008246415396.
Processing model 138 out of 160 with `Kernel Type` = Uniform and `h` = 2.235897435897436.
Finished processing model 138 with `R2 = 0.2325617621229631.
Processing model 139 out of 160 with `Kernel Type` = Uniform and `h` = 2.3615384615384616.
Finished processing model 139 with `R2 = 0.3134164718674928.
Processing model 140 out of 160 with `Kernel Type` = Uniform and `h` = 2.4871794871794872.
Finished processing model 140 with `R2 = 0.4651234172687694.
Processing model 141 out of 160 with `Kernel Type` = Uniform and `h` = 2.612820512820513.
Finished processing model 141 with `R2 = 0.49414730621444447.
Processing model 142 out of 160 with `Kernel Type` = Uniform and `h` = 2.7384615384615385.
Finished processing model 142 with `R2 = 0.5077244294046401.
Processing model 143 out of 160 with `Kernel Type` = Uniform and `h` = 2.864102564102564.
Finished processing model 143 with `R2 = 0.5374492229871592.
Processing model 144 out of 160 with `Kernel Type` = Uniform and `h` = 2.98974358974359.
Finished processing model 144 with `R2 = 0.5822884964527504.
Processing model 145 out of 160 with `Kernel Type` = Uniform and `h` = 3.1153846153846154.
Finished processing model 145 with `R2 = 0.5925737977743148.
Processing model 146 out of 160 with `Kernel Type` = Uniform and `h` = 3.241025641025641.
Finished processing model 146 with `R2 = 0.5998260987425498.
Processing model 147 out of 160 with `Kernel Type` = Uniform and `h` = 3.3666666666666667.
Finished processing model 147 with `R2 = 0.6583541636039493.
Processing model 148 out of 160 with `Kernel Type` = Uniform and `h` = 3.4923076923076923.
Finished processing model 148 with `R2 = 0.6711108392834786.
Processing model 149 out of 160 with `Kernel Type` = Uniform and `h` = 3.617948717948718.
Finished processing model 149 with `R2 = 0.6637873679595536.
Processing model 150 out of 160 with `Kernel Type` = Uniform and `h` = 3.7435897435897436.
Finished processing model 150 with `R2 = 0.6920033795227634.
Processing model 151 out of 160 with `Kernel Type` = Uniform and `h` = 3.8692307692307693.
Finished processing model 151 with `R2 = 0.6767811372984631.
Processing model 152 out of 160 with `Kernel Type` = Uniform and `h` = 3.994871794871795.
Finished processing model 152 with `R2 = 0.6799493836780217.
Processing model 153 out of 160 with `Kernel Type` = Uniform and `h` = 4.12051282051282.
Finished processing model 153 with `R2 = 0.6763381418744615.
Processing model 154 out of 160 with `Kernel Type` = Uniform and `h` = 4.246153846153845.
Finished processing model 154 with `R2 = 0.6736419981648771.
Processing model 155 out of 160 with `Kernel Type` = Uniform and `h` = 4.371794871794871.
Finished processing model 155 with `R2 = 0.6636367477342335.
Processing model 156 out of 160 with `Kernel Type` = Uniform and `h` = 4.4974358974358974.
Finished processing model 156 with `R2 = 0.665475504089279.
Processing model 157 out of 160 with `Kernel Type` = Uniform and `h` = 4.623076923076923.
Finished processing model 157 with `R2 = 0.6889690301795104.
Processing model 158 out of 160 with `Kernel Type` = Uniform and `h` = 4.748717948717948.
Finished processing model 158 with `R2 = 0.6725476270461084.
Processing model 159 out of 160 with `Kernel Type` = Uniform and `h` = 4.874358974358974.
Finished processing model 159 with `R2 = 0.6637628825609654.
Processing model 160 out of 160 with `Kernel Type` = Uniform and `h` = 5.0.
Finished processing model 160 with `R2 = 0.663488209942994.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display Sorted Results (Descending)</span>
<span class="c1"># Pandas allows sorting data by any column using the `sort_values()` method</span>
<span class="c1"># The `head()` allows us to see only the the first values</span>
<span class="n">dfModelScore</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;R2&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Kernel Type</th>
      <th>h</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>43</th>
      <td>Gaussian</td>
      <td>0.476923</td>
      <td>0.879523</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Gaussian</td>
      <td>0.602564</td>
      <td>0.861091</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Gaussian</td>
      <td>0.351282</td>
      <td>0.846588</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Gaussian</td>
      <td>0.728205</td>
      <td>0.831809</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Gaussian</td>
      <td>0.853846</td>
      <td>0.797958</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Cosine</td>
      <td>2.361538</td>
      <td>0.789725</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Cosine</td>
      <td>2.487179</td>
      <td>0.785513</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Cosine</td>
      <td>2.612821</td>
      <td>0.772574</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Cosine</td>
      <td>2.738462</td>
      <td>0.769903</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Gaussian</td>
      <td>0.979487</td>
      <td>0.763546</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting the Train Data F1 as a Heat Map</span>
<span class="c1"># We can pivot the data set created to have a 2D matrix of the score as a function of parameters.</span>

<span class="n">hF</span><span class="p">,</span> <span class="n">hA</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="c1"># hA = sns.heatmap(data = dfModelScore.pivot(index = &#39;h&#39;, columns = &#39;Kernel Type&#39;, values = &#39;R2&#39;), robust = True, linewidths = 1, annot = True, fmt = &#39;0.2f&#39;, norm = LogNorm(), ax = hA)</span>
<span class="n">hA</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">dfModelScore</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;Kernel Type&#39;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="s1">&#39;R2&#39;</span><span class="p">),</span> <span class="n">robust</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">linewidths</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;0.2f&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">hA</span><span class="p">)</span>
<span class="n">hA</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;R2 of the Cross Validation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/71af0d9f8c3fecae7aaca838e986f97cd61b0fc5050371324c5584caf0ed79ae.png" src="../../../../_images/71af0d9f8c3fecae7aaca838e986f97cd61b0fc5050371324c5584caf0ed79ae.png" />
</div>
</div>
<ul class="simple">
<li><p><font color='red'>(<strong>?</strong>)</font> What’s the actual model in production for Kernel Regression?</p></li>
<li><p><font color='brown'>(<strong>#</strong>)</font> In production we’d extract the best hyper parameters and then train again on the whole data.</p></li>
<li><p><font color='brown'>(<strong>#</strong>)</font> Usually, for best hyper parameters, it is better to use cross validation with low number of folds.<br />
Using Leave One Out is better for estimating real world performance. The logic is that the best hyper parameters should be selected when they are tested with low correlation of the data.</p></li>
</ul>
<section id="regression-results">
<h3>Regression Results<a class="headerlink" href="#regression-results" title="Permalink to this heading">#</a></h3>
<p>Results of the best model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Optimal Model</span>

<span class="c1"># Extract best model Hyper Parameters</span>
<span class="n">bestModelIdx</span>    <span class="o">=</span> <span class="n">dfModelScore</span><span class="p">[</span><span class="s1">&#39;R2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
<span class="n">kernelType</span>      <span class="o">=</span> <span class="n">dfModelScore</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bestModelIdx</span><span class="p">,</span> <span class="s1">&#39;Kernel Type&#39;</span><span class="p">]</span>
<span class="n">paramH</span>          <span class="o">=</span> <span class="n">dfModelScore</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">bestModelIdx</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>

<span class="c1"># Construct &amp; Train best model</span>
<span class="n">oKerReg</span> <span class="o">=</span> <span class="n">KernelRegressor</span><span class="p">(</span><span class="n">kernelType</span> <span class="o">=</span> <span class="n">kernelType</span><span class="p">,</span> <span class="n">paramH</span> <span class="o">=</span> <span class="n">paramH</span><span class="p">)</span>
<span class="n">oKerReg</span> <span class="o">=</span> <span class="n">oKerReg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">mX</span><span class="p">,</span> <span class="n">vY</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot Regression Results</span>

<span class="n">hF</span><span class="p">,</span> <span class="n">hA</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">hA</span> <span class="o">=</span> <span class="n">PlotRegressionResults</span><span class="p">(</span><span class="n">vY</span><span class="p">,</span> <span class="n">oKerReg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">mX</span><span class="p">),</span> <span class="n">hA</span> <span class="o">=</span> <span class="n">hA</span><span class="p">)</span>
<span class="n">hA</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Input Price [1000$]&#39;</span><span class="p">)</span>
<span class="n">hA</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted Price [1000$]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Predicted Price [1000$]&#39;)
</pre></div>
</div>
<img alt="../../../../_images/1503f791363257aae7cb0664f839b1b18b83c16654d21a119cd3b8859fe9827a.png" src="../../../../_images/1503f791363257aae7cb0664f839b1b18b83c16654d21a119cd3b8859fe9827a.png" />
</div>
</div>
</section>
<section id="vectorized-cross-validation-for-kernel-regression">
<h3>Vectorized Cross Validation for Kernel Regression<a class="headerlink" href="#vectorized-cross-validation-for-kernel-regression" title="Permalink to this heading">#</a></h3>
<p>One way to optimize the process is by pre calculating the distance matrix for the whole data.<br />
Then using a sub set of it according to the subset for training.</p>
<p>For instance, let’s recreate the <em>Leave One Out</em>:</p>
<ol class="arabic simple">
<li><p>Calculate the Distance Matrix <span class="math notranslate nohighlight">\(\boldsymbol{D}_{x} \in \mathbb{R}^{N \times N}\)</span> such that <span class="math notranslate nohighlight">\( \boldsymbol{D}_{x} \left[ i, j \right] = \left\| \boldsymbol{x}_{i}-\boldsymbol{x}_{j} \right\| _{2}\)</span>.</p></li>
<li><p>Calculate the weights matrix <span class="math notranslate nohighlight">\(\boldsymbol{W} \in \mathbb{R}^{N \times N}\)</span> such that <span class="math notranslate nohighlight">\(\boldsymbol{W} \left[ i, j \right] = k \left( \frac{1}{h} \boldsymbol{D}_{x} \left[ i, j \right] \right)\)</span>.</p></li>
<li><p>Estimate <span class="math notranslate nohighlight">\(\boldsymbol{x}_{i}\)</span> without using <span class="math notranslate nohighlight">\(\boldsymbol{x}_{i}\)</span> we set <span class="math notranslate nohighlight">\(\boldsymbol{W} \left[ i, i \right] = 0\)</span>.</p></li>
<li><p>Apply kernel regression <span class="math notranslate nohighlight">\(\hat{\boldsymbol{y}} = \left( \boldsymbol{W} \boldsymbol{y} \right) \oslash \left( \boldsymbol{W} \boldsymbol{1} \right)\)</span>. Where <span class="math notranslate nohighlight">\(\oslash\)</span> is element wise division.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Vectorized Leave One Out Kernel Regression</span>

<span class="n">numSamples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vY</span><span class="p">)</span> <span class="c1">#&lt;! Number of Samples</span>
<span class="n">hK</span> <span class="o">=</span> <span class="n">GaussianKernel</span> <span class="c1">#&lt;! Kernel</span>
<span class="n">paramH</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1">#&lt;! Bandwidth</span>
<span class="n">mD</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">cdist</span><span class="p">(</span><span class="n">mX</span><span class="p">,</span> <span class="n">mX</span><span class="p">,</span> <span class="n">metric</span> <span class="o">=</span> <span class="s1">&#39;euclidean&#39;</span><span class="p">)</span> <span class="c1">#&lt;! Distance Matrix</span>
<span class="n">mW</span> <span class="o">=</span> <span class="n">hK</span><span class="p">(</span><span class="n">mD</span> <span class="o">/</span> <span class="n">paramH</span><span class="p">)</span> <span class="c1">#&lt;! Weights matrix</span>

<span class="c1"># Zeroing the diagonal to prevent the weight of the sample</span>
<span class="n">mW</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">numSamples</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">numSamples</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#&lt;! Leave One Out</span>
<span class="n">vYPred</span> <span class="o">=</span> <span class="p">(</span><span class="n">mW</span> <span class="o">@</span> <span class="n">vY</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mW</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="c1">#&lt;! Kernel Regression</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The Leave One Out R2 Score for Kernel Type = </span><span class="si">{</span><span class="n">hK</span><span class="si">}</span><span class="s1"> and Bandwidth = </span><span class="si">{</span><span class="n">paramH</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">r2_score</span><span class="p">(</span><span class="n">vY</span><span class="p">,</span><span class="w"> </span><span class="n">vYPred</span><span class="p">)</span><span class="w"> </span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Leave One Out R2 Score for Kernel Type = &lt;function GaussianKernel at 0x7fa46e8e8220&gt; and Bandwidth = 0.3 is 0.8861968191595648.
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><font color='green'>(<strong>&#64;</strong>)</font> Plot the regression of the best model (See previous notebooks).</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./00_ai24/01_ml/06_nonParam/kernelReg"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="0050RegressorKernel.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Kernel Regression</p>
      </div>
    </a>
    <a class="right-next"
       href="../polyReg/readme.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Polynomial Regression</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#revision-history">Revision History</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notations">Notations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-exercise">Code Exercise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-regression">Kernel Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-load-data">Generate / Load Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-data">Plot Data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-test-data">Training / Test Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-regressor">Kernel Regressor</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-regression-estimator">Kernel Regression Estimator</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-a-model-and-optimize-hyper-parameters">Train a Model and Optimize Hyper Parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-results">Regression Results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vectorized-cross-validation-for-kernel-regression">Vectorized Cross Validation for Kernel Regression</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 0xsol
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>